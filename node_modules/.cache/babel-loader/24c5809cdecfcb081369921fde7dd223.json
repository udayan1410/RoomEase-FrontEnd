{"ast":null,"code":"var _jsxFileName = \"E:\\\\Web Dev\\\\React\\\\RoomEase\\\\RoomEase-FrontEnd\\\\src\\\\containers\\\\SplitEase\\\\SplitEaseFeed\\\\SplitEaseFeed.js\";\nimport React, { Component } from 'react';\nimport * as SplitEaseServerRoutes from '../../../constants/ServerRoutes';\nimport Axios from 'axios';\nimport { connect } from 'react-redux';\nimport Auxillary from '../../../hoc/Auxillary';\nimport classes from './spliteasefeed.module.css';\nimport Backdrop from '../../../components/Backdrop/Backdrop';\nimport Modal from '../../../components/Modal/Modal';\nimport RegularButton from '../../../components/inputs/RegularButton';\n\nclass SplitEaseFeed extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      userID: null,\n      feed: [],\n      modalOpen: false,\n      currentExpense: null,\n      expenseData: null\n    };\n\n    this.modalToggle = async id => {\n      let modalOpen = !this.state.modalOpen;\n      if (typeof id !== \"string\") this.setState({\n        currentExpense: null\n      });else this.setState({\n        currentExpense: this.state.feed.filter(f => f._id === id)[0]\n      });\n\n      if (modalOpen) {\n        // console.log(id);\n        let expenseData = (await Axios.get(`${SplitEaseServerRoutes.SPLIT_EASE_GET_EXPENSE_DETAILS}?expenseID=${id}`)).data.data;\n        this.setState({\n          expenseData: expenseData\n        });\n        if (expenseData.expenseType !== \"payback\") this.setState({\n          modalOpen\n        });\n      } else this.setState({\n        modalOpen\n      });\n    };\n\n    this.fetchFeedData = async userID => {\n      let splitWiseFeedModel = await Axios.get(`${SplitEaseServerRoutes.SPLIT_EASE_GET_EXPENSE_FEED}?userID=${userID}`);\n      let {\n        data: {\n          feed\n        }\n      } = splitWiseFeedModel; // console.log(feed);\n\n      this.setState({\n        feed\n      });\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.userID && !this.state.userID) {\n      // console.log(\"In if mount\");\n      this.setState({\n        userID: this.props.userID\n      }, () => this.fetchFeedData(this.props.userID));\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.props.userID && !this.state.userID) {\n      // console.log(\"In if update\");\n      this.setState({\n        userID: this.props.userID\n      }, () => this.fetchFeedData(this.props.userID));\n    }\n  }\n\n  render() {\n    let renderList = () => {\n      let list = /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.FeedList,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 17\n        }\n      }, this.state.feed.map(activity => {\n        let note = activity.description;\n        let DescriptionClasses = [classes.Subheading, note.includes(\"You\") ? classes.SubheadingSuccess : classes.SubheadingWarning];\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: classes.FeedContainer,\n          key: activity._id,\n          onClick: () => this.modalToggle(activity.expenseID),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 29\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: classes.TotalValue,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 33\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: classes.ValueCircle,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 37\n          }\n        }, activity.value, \"$\")), /*#__PURE__*/React.createElement(\"div\", {\n          className: classes.Feed,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 33\n          }\n        }, /*#__PURE__*/React.createElement(\"p\", {\n          className: classes.Description,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 37\n          }\n        }, activity.description), /*#__PURE__*/React.createElement(\"p\", {\n          className: DescriptionClasses.join(\" \"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 37\n          }\n        }, activity.subheading), /*#__PURE__*/React.createElement(\"p\", {\n          className: classes.Date,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 37\n          }\n        }, activity.date)));\n      }));\n      return list;\n    };\n\n    let modal = null; //All the code will be executed only if modal is open\n\n    if (this.state.modalOpen) {\n      let expenseData = this.state.expenseData;\n      let {\n        description,\n        to: {\n          userName,\n          _id\n        },\n        eachContribution,\n        from,\n        deleted,\n        expenseType\n      } = expenseData;\n      let totalCost = `$ ${(eachContribution * (from.length + 1)).toFixed(2)}`;\n      let totalOwedToMe = (eachContribution * from.length).toFixed(2);\n      let showDeleteButton = false;\n\n      if (_id === this.props.userID) {\n        userName = `You (${userName})`;\n        if (expenseType === \"expense\") showDeleteButton = true;\n      }\n\n      let expenseHeader = `${userName} ${deleted ? \"deleted expense\" : \"added\"} ${description}`;\n      let deleteButton = null;\n\n      if (showDeleteButton) {\n        deleteButton = /*#__PURE__*/React.createElement(RegularButton, {\n          text: \"Delete\",\n          disabled: deleted,\n          onClick: async () => {\n            let deleteStatus = (await Axios.delete(`${SplitEaseServerRoutes.SPLIT_EASE_REMOVE_EXPENSE}?expenseID=${expenseData._id}`)).data; // console.log(deleteStatus);\n\n            if (deleteStatus.Result === \"Success\") {\n              this.modalToggle();\n            }\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 33\n          }\n        });\n      }\n\n      modal = /*#__PURE__*/React.createElement(Auxillary, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Backdrop, {\n        show: this.state.modalOpen,\n        onClick: this.modalToggle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(Modal, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.ModalHeader,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: classes.ExpenseHeader,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 29\n        }\n      }, expenseHeader), /*#__PURE__*/React.createElement(\"p\", {\n        className: classes.TotalCost,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 29\n        }\n      }, totalCost)), /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.ModalBody,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: classes.ValueBreakdown,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 29\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 68\n        }\n      }, userName), \" paid \", /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 91\n        }\n      }, totalCost), \" and is owed \", /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 122\n        }\n      }, \"$\", totalOwedToMe)), from.map(f => {\n        return /*#__PURE__*/React.createElement(\"p\", {\n          className: classes.ValueBreakdown,\n          key: f._id,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 37\n          }\n        }, \" \", /*#__PURE__*/React.createElement(\"b\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 88\n          }\n        }, f.userName), \" owes \", /*#__PURE__*/React.createElement(\"b\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 113\n          }\n        }, \"$\", eachContribution));\n      }), deleteButton)));\n    }\n\n    return /*#__PURE__*/React.createElement(Auxillary, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 13\n      }\n    }, renderList(), modal);\n  }\n\n}\n\nlet mapStateToProps = state => {\n  return {\n    userID: state.userID\n  };\n};\n\nexport default connect(mapStateToProps, null)(SplitEaseFeed);","map":{"version":3,"sources":["E:/Web Dev/React/RoomEase/RoomEase-FrontEnd/src/containers/SplitEase/SplitEaseFeed/SplitEaseFeed.js"],"names":["React","Component","SplitEaseServerRoutes","Axios","connect","Auxillary","classes","Backdrop","Modal","RegularButton","SplitEaseFeed","state","userID","feed","modalOpen","currentExpense","expenseData","modalToggle","id","setState","filter","f","_id","get","SPLIT_EASE_GET_EXPENSE_DETAILS","data","expenseType","fetchFeedData","splitWiseFeedModel","SPLIT_EASE_GET_EXPENSE_FEED","componentDidMount","props","componentDidUpdate","render","renderList","list","FeedList","map","activity","note","description","DescriptionClasses","Subheading","includes","SubheadingSuccess","SubheadingWarning","FeedContainer","expenseID","TotalValue","ValueCircle","value","Feed","Description","join","subheading","Date","date","modal","to","userName","eachContribution","from","deleted","totalCost","length","toFixed","totalOwedToMe","showDeleteButton","expenseHeader","deleteButton","deleteStatus","delete","SPLIT_EASE_REMOVE_EXPENSE","Result","ModalHeader","ExpenseHeader","TotalCost","ModalBody","ValueBreakdown","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport * as SplitEaseServerRoutes from '../../../constants/ServerRoutes'\r\nimport Axios from 'axios';\r\nimport { connect } from 'react-redux';\r\nimport Auxillary from '../../../hoc/Auxillary';\r\nimport classes from './spliteasefeed.module.css';\r\nimport Backdrop from '../../../components/Backdrop/Backdrop';\r\nimport Modal from '../../../components/Modal/Modal';\r\nimport RegularButton from '../../../components/inputs/RegularButton';\r\n\r\nclass SplitEaseFeed extends Component {\r\n\r\n    state = {\r\n        userID: null,\r\n        feed: [],\r\n        modalOpen: false,\r\n        currentExpense: null,\r\n        expenseData: null,\r\n    }\r\n\r\n\r\n    modalToggle = async (id) => {\r\n        let modalOpen = !this.state.modalOpen\r\n\r\n        if (typeof id !== \"string\")\r\n            this.setState({ currentExpense: null });\r\n\r\n        else\r\n            this.setState({ currentExpense: this.state.feed.filter(f => f._id === id)[0] });\r\n\r\n        if (modalOpen) {\r\n            // console.log(id);\r\n            let expenseData = (await Axios.get(`${SplitEaseServerRoutes.SPLIT_EASE_GET_EXPENSE_DETAILS}?expenseID=${id}`)).data.data;\r\n            this.setState({ expenseData: expenseData })\r\n\r\n            if (expenseData.expenseType !== \"payback\")\r\n\r\n                this.setState({ modalOpen })\r\n        }\r\n        else\r\n            this.setState({ modalOpen })\r\n\r\n    }\r\n\r\n    fetchFeedData = async (userID) => {\r\n        let splitWiseFeedModel = (await Axios.get(`${SplitEaseServerRoutes.SPLIT_EASE_GET_EXPENSE_FEED}?userID=${userID}`));\r\n        let { data: { feed } } = splitWiseFeedModel;\r\n        // console.log(feed);\r\n        this.setState({ feed })\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.userID && !this.state.userID) {\r\n            // console.log(\"In if mount\");\r\n            this.setState({ userID: this.props.userID }, () => this.fetchFeedData(this.props.userID))\r\n        }\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        if (this.props.userID && !this.state.userID) {\r\n            // console.log(\"In if update\");\r\n            this.setState({ userID: this.props.userID }, () => this.fetchFeedData(this.props.userID))\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        let renderList = () => {\r\n            let list = (\r\n                <div className={classes.FeedList}>\r\n                    {this.state.feed.map(activity => {\r\n                        let note = activity.description;\r\n                        let DescriptionClasses = [classes.Subheading, note.includes(\"You\") ? classes.SubheadingSuccess : classes.SubheadingWarning];\r\n\r\n                        return (\r\n                            <div className={classes.FeedContainer} key={activity._id} onClick={() => this.modalToggle(activity.expenseID)}>\r\n                                <div className={classes.TotalValue}>\r\n                                    <div className={classes.ValueCircle}>{activity.value}$</div>\r\n                                </div>\r\n                                <div className={classes.Feed}>\r\n                                    <p className={classes.Description}>{activity.description}</p>\r\n                                    <p className={DescriptionClasses.join(\" \")}>{activity.subheading}</p>\r\n                                    <p className={classes.Date}>{activity.date}</p>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>);\r\n\r\n            return list;\r\n        }\r\n\r\n        let modal = null;\r\n\r\n\r\n        //All the code will be executed only if modal is open\r\n        if (this.state.modalOpen) {\r\n            let expenseData = this.state.expenseData;\r\n            let { description, to: { userName, _id }, eachContribution, from, deleted, expenseType } = expenseData;\r\n            let totalCost = `$ ${(eachContribution * (from.length + 1)).toFixed(2)}`;\r\n            let totalOwedToMe = (eachContribution * (from.length)).toFixed(2);\r\n            let showDeleteButton = false;\r\n\r\n            if (_id === this.props.userID) {\r\n                userName = `You (${userName})`;\r\n\r\n                if (expenseType === \"expense\")\r\n                    showDeleteButton = true;\r\n            }\r\n\r\n            let expenseHeader = `${userName} ${deleted ? \"deleted expense\" : \"added\"} ${description}`;\r\n\r\n            let deleteButton = null;\r\n            if (showDeleteButton) {\r\n                deleteButton = (<RegularButton\r\n                    text=\"Delete\"\r\n                    disabled={deleted}\r\n                    onClick={async () => {\r\n                        let deleteStatus = (await Axios.delete(`${SplitEaseServerRoutes.SPLIT_EASE_REMOVE_EXPENSE}?expenseID=${expenseData._id}`)).data;\r\n                        // console.log(deleteStatus);\r\n                        if (deleteStatus.Result === \"Success\") {\r\n                            this.modalToggle();\r\n                        }\r\n                    }}\r\n                />\r\n                );\r\n            }\r\n\r\n            modal = (\r\n                <Auxillary>\r\n                    <Backdrop\r\n                        show={this.state.modalOpen}\r\n                        onClick={this.modalToggle}\r\n                    />\r\n\r\n                    <Modal>\r\n                        <div className={classes.ModalHeader}>\r\n                            <p className={classes.ExpenseHeader}>{expenseHeader}</p>\r\n                            <p className={classes.TotalCost}>{totalCost}</p>\r\n                        </div>\r\n                        <div className={classes.ModalBody}>\r\n                            <p className={classes.ValueBreakdown}> <b>{userName}</b> paid <b>{totalCost}</b> and is owed <b>${totalOwedToMe}</b></p>\r\n                            {from.map(f => {\r\n                                return (\r\n                                    <p className={classes.ValueBreakdown} key={f._id}> <b>{f.userName}</b> owes <b>${eachContribution}</b></p>\r\n                                )\r\n                            })}\r\n                            {deleteButton}\r\n                        </div>\r\n                    </Modal>\r\n                </Auxillary>\r\n            )\r\n        }\r\n\r\n\r\n        return (\r\n            <Auxillary>\r\n                {renderList()}\r\n                {modal}\r\n            </Auxillary>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nlet mapStateToProps = state => {\r\n    return {\r\n        userID: state.userID\r\n    }\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps, null)(SplitEaseFeed);"]},"metadata":{},"sourceType":"module"}